<!--
  Auteur: Robin Manintveld
  Datum: 22-01-2026
  Omschrijving: Detailsheets aanmaken - Volledige functionaliteit (Refactored Tabs)
-->

<Window x:Class="VH_Addin.Views.DetailSheetsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Detailsheets aanmaken"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        MinWidth="1440"
        MinHeight="920"
        Width="1440"
        Height="920"
        ResizeMode="NoResize"
        FontFamily="Segoe UI">
    <Window.Resources>
        <SolidColorBrush x:Key="T" Color="#2B2B2B"/>
        <SolidColorBrush x:Key="Gold" Color="#B2996B"/>
        <SolidColorBrush x:Key="GoldHover" Color="#A08D61"/>
        <SolidColorBrush x:Key="Neutral" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="NeutralText" Color="#333333"/>
        <SolidColorBrush x:Key="NeutralBorder" Color="#D1D5DB"/>
        <SolidColorBrush x:Key="MutedText" Color="#6B7280"/>

        <!-- Card Style -->
        <Style x:Key="Card" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource Gold}"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <!-- GroupBox Style -->
        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Border Style="{StaticResource Card}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Margin="4,0,0,4" FontWeight="Bold" FontSize="12"
                                         Foreground="{StaticResource T}" Text="{TemplateBinding Header}"/>
                                <ContentPresenter Grid.Row="1" Margin="4,0,4,4"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Label Style -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#6B7280"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,12,0"/>
        </Style>

        <!-- TextBox Style -->
        <Style x:Key="InputBox" TargetType="TextBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- ComboBox Style -->
        <Style x:Key="InputCombo" TargetType="ComboBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>

        <!-- Premium DataGrid Style -->
        <Style x:Key="PremiumDataGrid" TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="IsReadOnly" Value="False"/>
            <Setter Property="SelectionMode" Value="Extended"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="BorderBrush" Value="{StaticResource Gold}"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Setter Property="RowHeight" Value="24"/>
            <Setter Property="AlternatingRowBackground" Value="#F8FAFC"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#F1F5F9"/>
                        <Setter Property="Foreground" Value="{StaticResource T}"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Padding" Value="10,8"/>
                        <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="10,0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                        <ContentPresenter VerticalAlignment="Center" />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#EDE9FE"/>
                                <Setter Property="Foreground" Value="Black"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- CheckBox Style -->
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="0,4,0,4"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- Selection buttons: white, black border, 8px radius (MATCH ViewDuplicator BtnSecondaryWhite) -->
        <Style x:Key="BtnSelection" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Padding" Value="16,6"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F8F8F8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button (Gold) -->
        <Style x:Key="BtnGold" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource Gold}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="24,10"/>
            <Setter Property="MinWidth" Value="140"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="Black"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#A08D61"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Secondary Button (White) -->
        <Style x:Key="BtnSecondary" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="24,10"/>
            <Setter Property="MinWidth" Value="140"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="Black"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F8F8F8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Pill Tab Button Style (Inactive) (MATCH ViewDuplicator PillTabButton) -->
        <Style x:Key="PillTabButton" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="{StaticResource NeutralText}"/>
            <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="20,8"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F3F4F6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Pill Tab Button Style (Active) (MATCH ViewDuplicator PillTabButtonActive) -->
        <Style x:Key="PillTabButtonActive" TargetType="Button" BasedOn="{StaticResource PillTabButton}">
            <Setter Property="Background" Value="#B2996B"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#A08D61"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid Styling -->
        <Style TargetType="DataGridRow">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFF8F1E6"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- Main Container with Shadow -->
        <Border Background="White"
                CornerRadius="16"
                Margin="24,24,24,88">
            <Border.Effect>
                <DropShadowEffect Color="Black" Direction="270" ShadowDepth="2" BlurRadius="20" Opacity="0.15"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>  <!-- Title Bar -->
                    <RowDefinition Height="Auto"/>  <!-- Tabs Header -->
                    <RowDefinition Height="*"/>     <!-- Content -->
                </Grid.RowDefinitions>

                <!-- Draggable Title Bar -->
                <Border Grid.Row="0" 
                        Background="#F8FAFC"
                        CornerRadius="16,16,0,0"
                        Padding="24,16"
                        MouseDown="TitleBar_MouseDown">
                    <TextBlock Text="Detailsheets aanmaken"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{StaticResource T}"
                               VerticalAlignment="Center"/>
                </Border>

                <!-- Custom Tabs Container -->
                <Border Grid.Row="1" 
                        Background="White"
                        BorderBrush="{StaticResource NeutralBorder}"
                        BorderThickness="0"
                        Padding="24,8">
                    <StackPanel x:Name="tabButtons" Orientation="Horizontal">
                        <!-- Buttons will be toggled in code-behind -->
                        <Button x:Name="btnTabSelectie" Content="Selectie" Click="BtnTabSelectie_Click" Style="{StaticResource PillTabButtonActive}"/>
                        <Button x:Name="btnTabResultaten" Content="Resultaten" Click="BtnTabResultaten_Click" Style="{StaticResource PillTabButton}"/>
                    </StackPanel>
                </Border>

                <!-- Content Area -->
                <Grid Grid.Row="2" Margin="24,8,24,24">
                    
                    <!-- View 1: Selectie -->
                    <Grid x:Name="tabContentSelectie" Visibility="Visible">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>  <!-- Left: Settings -->
                                <ColumnDefinition Width="24"/>
                                <ColumnDefinition Width="3*"/>    <!-- Right: Views & Filter -->
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>  <!-- Row 0: Titelblok / Zoeken -->
                                <RowDefinition Height="*"/>     <!-- Row 1: Nummering / Views (stretching) -->
                                <RowDefinition Height="Auto"/>  <!-- Row 2: Parameters / Selectie -->
                            </Grid.RowDefinitions>

                            <!-- LEFT COLUMN -->
                            <!-- Titelblok -->
                            <GroupBox Grid.Column="0" Grid.Row="0" Header="Titelblok" VerticalAlignment="Top">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Type:" Style="{StaticResource LabelStyle}"/>
                                        <ComboBox Grid.Column="1" x:Name="cmbTitleBlock" Style="{StaticResource InputCombo}"/>
                                    </Grid>
                                    <CheckBox x:Name="chkPlaceViews" Content="Views plaatsen op sheet (standaard)" Margin="0,10,0,0" IsChecked="True"/>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="16"/>
                                            <ColumnDefinition Width="70"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Offset X/Y (mm):" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Column="1" x:Name="tbOffsetX" Style="{StaticResource InputBox}" Text="0" TextAlignment="Center"/>
                                        <TextBox Grid.Column="3" x:Name="tbOffsetY" Style="{StaticResource InputBox}" Text="250" TextAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </GroupBox>

                            <!-- Nummering & naam -->
                            <GroupBox Grid.Column="0" Grid.Row="1" Header="Nummering &amp; naam" VerticalAlignment="Bottom">
                                <Grid VerticalAlignment="Top">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="14"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="12"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="12"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="12"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="12"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Sheetnummer:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" x:Name="tbNumberTemplate" Style="{StaticResource InputBox}"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Sheetnaam:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" x:Name="tbNameTemplate" Style="{StaticResource InputBox}"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Prefix:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="3" x:Name="tbPrefix" Style="{StaticResource InputBox}"/>

                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Find / Replace:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Row="6" Grid.Column="1" x:Name="tbFind" Style="{StaticResource InputBox}"/>
                                    <TextBlock Grid.Row="6" Grid.Column="2" Text="/" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="6" Grid.Column="3" x:Name="tbReplace" Style="{StaticResource InputBox}"/>

                                    <TextBlock Grid.Row="8" Grid.Column="0" Text="Suffix:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Row="8" Grid.Column="1" Grid.ColumnSpan="3" x:Name="tbSuffix" Style="{StaticResource InputBox}"/>
                                </Grid>
                            </GroupBox>

                            <!-- Parameters -->
                            <GroupBox Grid.Column="0" Grid.Row="2" Header="Parameters (Sheet &amp; Project)">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="12"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Column 1: Sheet -->
                                    <Grid Grid.Column="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Tekenaar:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="tbTekenaar" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Datum:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="tbDatum" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Tek. fase:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="4" Grid.Column="1" x:Name="tbTekFase" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="6" Grid.Column="0" Text="Tek. status:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="6" Grid.Column="1" x:Name="tbTekStatus" Style="{StaticResource InputBox}"/>
                                    </Grid>

                                    <!-- Column 2: Project -->
                                    <Grid Grid.Column="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Bouwdeel:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="tbBouwdeel" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Categorie:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="tbCategorie" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Fase:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="4" Grid.Column="1" x:Name="tbFase" Style="{StaticResource InputBox}"/>

                                        <TextBlock Grid.Row="6" Grid.Column="0" Text="Onderdeel:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="6" Grid.Column="1" x:Name="tbOnderdeel" Style="{StaticResource InputBox}"/>
                                    </Grid>
                                </Grid>
                            </GroupBox>

                            <!-- RIGHT COLUMN -->
                            <Grid Grid.Column="2" Grid.RowSpan="3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>  <!-- Zoeken & Filter -->
                                    <RowDefinition Height="*"/>     <!-- Views -->
                                    <RowDefinition Height="Auto"/>  <!-- Selectie -->
                                </Grid.RowDefinitions>

                                <!-- Zoeken & Filter -->
                                <GroupBox Grid.Row="0" Header="Zoeken &amp; Filter">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="16"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="8"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Filterveld:" Style="{StaticResource LabelStyle}"/>
                                        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="cmbFilterField" Style="{StaticResource InputCombo}"/>
                                        <ComboBox Grid.Row="0" Grid.Column="3" x:Name="cmbFilterValue" Style="{StaticResource InputCombo}"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Zoeken:" Style="{StaticResource LabelStyle}"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" x:Name="tbSearch" Style="{StaticResource InputBox}"/>
                                    </Grid>
                                </GroupBox>

                                <!-- Views -->
                                <GroupBox Grid.Row="1" Header="Views">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <StackPanel x:Name="viewsPanel" HorizontalAlignment="Left"/>
                                    </ScrollViewer>
                                </GroupBox>

                                <!-- Selectie -->
                                <GroupBox Grid.Row="2" Header="Selectie">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                            <Button x:Name="btnSelectAll" Content="Alle" Style="{StaticResource BtnSelection}" Margin="0,0,8,0"/>
                                            <Button x:Name="btnSelectNone" Content="Geen" Style="{StaticResource BtnSelection}"/>
                                        </StackPanel>

                                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button x:Name="btnAddHorizontal" Content="Detail horizontaal" Style="{StaticResource BtnSelection}" Margin="0,0,8,0"/>
                                            <Button x:Name="btnAddVertical" Content="Detail verticaal" Style="{StaticResource BtnSelection}"/>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </Grid>
                    </Grid>

                    <!-- View 2: Resultaten -->
                    <Grid x:Name="tabContentResultaten" Visibility="Collapsed">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>  <!-- Naam bewerken -->
                                <RowDefinition Height="*"/>     <!-- DataGrids -->
                                <RowDefinition Height="Auto"/>  <!-- Selectie -->
                            </Grid.RowDefinitions>

                            <!-- Naam bewerken -->
                            <GroupBox Grid.Row="0" Header="Naam bewerken">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="16"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="16"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0" Text="Find:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Column="1" x:Name="fxTxtFind" Style="{StaticResource InputBox}"/>

                                    <TextBlock Grid.Column="3" Text="Replace:" Style="{StaticResource LabelStyle}"/>
                                    <TextBox Grid.Column="4" x:Name="fxTxtReplace" Style="{StaticResource InputBox}"/>

                                    <Button Grid.Column="6" x:Name="btnApplyFindReplace" Content="Toepassen" Style="{StaticResource BtnGold}" Margin="0,0,8,0"/>
                                    <Button Grid.Column="7" x:Name="btnResetNames" Content="Reset" Style="{StaticResource BtnSecondary}"/>
                                </Grid>
                            </GroupBox>

                            <!-- DataGrids -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="24"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Details horizontaal -->
                                <GroupBox Grid.Column="0" Header="Details horizontaal">
                                    <DataGrid x:Name="gridHorizontal" 
                                              Style="{StaticResource PremiumDataGrid}">
                                        <DataGrid.Columns>
                                            <DataGridCheckBoxColumn Header="Sel" Binding="{Binding Selected, UpdateSourceTrigger=PropertyChanged}" Width="45"/>
                                            <DataGridTextColumn Header="Nummer (gen.)" Binding="{Binding GeneratedNumber}" IsReadOnly="True" Width="130"/>
                                            <DataGridTextColumn Header="Sheetnummer" Binding="{Binding Sheetnr, UpdateSourceTrigger=PropertyChanged}" Width="110"/>
                                            <DataGridTextColumn Header="Titelblok" Binding="{Binding TitleBlock, UpdateSourceTrigger=PropertyChanged}" Width="1*"/>
                                            <DataGridTextColumn Header="Naam" Binding="{Binding SheetName, UpdateSourceTrigger=PropertyChanged}" Width="1.5*"/>
                                            <DataGridTextColumn Header="View" Binding="{Binding ViewName}" IsReadOnly="True" Width="1*"/>
                                            <DataGridCheckBoxColumn Header="Plaatsen?" Binding="{Binding PlaceView, UpdateSourceTrigger=PropertyChanged}" Width="75"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </GroupBox>

                                <!-- Details verticaal -->
                                <GroupBox Grid.Column="2" Header="Details verticaal">
                                    <DataGrid x:Name="gridVertical" 
                                              Style="{StaticResource PremiumDataGrid}">
                                        <DataGrid.Columns>
                                            <DataGridCheckBoxColumn Header="Sel" Binding="{Binding Selected, UpdateSourceTrigger=PropertyChanged}" Width="45"/>
                                            <DataGridTextColumn Header="Nummer (gen.)" Binding="{Binding GeneratedNumber}" IsReadOnly="True" Width="130"/>
                                            <DataGridTextColumn Header="Sheetnummer" Binding="{Binding Sheetnr, UpdateSourceTrigger=PropertyChanged}" Width="110"/>
                                            <DataGridTextColumn Header="Titelblok" Binding="{Binding TitleBlock, UpdateSourceTrigger=PropertyChanged}" Width="1*"/>
                                            <DataGridTextColumn Header="Naam" Binding="{Binding SheetName, UpdateSourceTrigger=PropertyChanged}" Width="1.5*"/>
                                            <DataGridTextColumn Header="View" Binding="{Binding ViewName}" IsReadOnly="True" Width="1*"/>
                                            <DataGridCheckBoxColumn Header="Plaatsen?" Binding="{Binding PlaceView, UpdateSourceTrigger=PropertyChanged}" Width="75"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </GroupBox>
                            </Grid>

                            <!-- Selectie -->
                            <GroupBox Grid.Row="2" Header="Selectie">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                                        <Button x:Name="btnResultsSelectAll" Content="Alle" Style="{StaticResource BtnSelection}" Margin="0,0,8,0"/>
                                        <Button x:Name="btnResultsSelectNone" Content="Geen" Style="{StaticResource BtnSelection}"/>
                                    </StackPanel>

                                    <Button Grid.Column="1" x:Name="btnDeleteSelected" Content="Verwijderen" Style="{StaticResource BtnSelection}" HorizontalAlignment="Right"/>
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Border>

        <StackPanel Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    VerticalAlignment="Bottom"
                    Margin="0,0,24,24">
            <Button x:Name="btnCancel" 
                    Content="Annuleren" 
                    Click="BtnCancel_Click"
                    IsCancel="True"
                    Style="{StaticResource BtnSecondary}"
                    Margin="0,0,12,0"/>

            <Button x:Name="btnExecute" 
                    Content="Uitvoeren" 
                    Click="BtnExecute_Click"
                    Style="{StaticResource BtnGold}"/>
        </StackPanel>
    </Grid>
</Window>
