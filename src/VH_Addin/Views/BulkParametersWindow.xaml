<!--
  Auteur: Robin Manintveld
  Datum: 22-01-2026
  Omschrijving: Hoofdvenster voor bulk parameterbewerking (VH Tools)
-->

<Window x:Class="VH_Tools.Views.BulkParametersWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Bulk parameters"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Width="1400" Height="960"
        ResizeMode="NoResize"
        FontFamily="Segoe UI">

  <Window.Resources>
    <!-- Colors matching ViewDuplicator -->
    <SolidColorBrush x:Key="T" Color="#2B2B2B"/>
    <SolidColorBrush x:Key="Gold" Color="#B2996B"/>
    <SolidColorBrush x:Key="Neutral" Color="#E5E7EB"/>
    <SolidColorBrush x:Key="NeutralText" Color="#333333"/>
    <SolidColorBrush x:Key="NeutralBorder" Color="#D1D5DB"/>

    <!-- Card Style -->
    <Style x:Key="Card" TargetType="Border">
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="{StaticResource Gold}"/>
      <Setter Property="BorderThickness" Value="1.5"/>
      <Setter Property="CornerRadius" Value="8"/>
      <Setter Property="Padding" Value="16"/>
      <Setter Property="Margin" Value="0,0,0,16"/>
    </Style>

    <!-- GroupBox Style -->
    <Style TargetType="GroupBox">
      <Setter Property="Margin" Value="0,0,0,16"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="GroupBox">
            <Border Style="{StaticResource Card}">
              <DockPanel>
                <TextBlock DockPanel.Dock="Top" Margin="2,0,0,8" FontWeight="Bold" 
                          Foreground="{StaticResource T}" Text="{TemplateBinding Header}"/>
                <ContentPresenter Margin="0"/>
              </DockPanel>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- TextBox Style -->
    <Style x:Key="StdTextBox" TargetType="TextBox">
      <Setter Property="Height" Value="32"/>
      <Setter Property="Padding" Value="8,6"/>
      <Setter Property="Background" Value="White"/>
      <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="FontSize" Value="13"/>
    </Style>

    <!-- ComboBox Style -->
    <Style x:Key="StdComboBox" TargetType="ComboBox">
      <Setter Property="Height" Value="32"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="FontSize" Value="13"/>
    </Style>

    <!-- CheckBox Style -->
    <Style TargetType="CheckBox">
      <Setter Property="Margin" Value="0,4,0,4"/>
    </Style>

    <!-- Primary Button (Gold) -->
    <Style x:Key="BtnGold" TargetType="Button">
      <Setter Property="Background" Value="{StaticResource Gold}"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="Height" Value="40"/>
      <Setter Property="Padding" Value="24,10"/>
      <Setter Property="MinWidth" Value="140"/>
      <Setter Property="FontSize" Value="13"/>
      <Setter Property="FontWeight" Value="Medium"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border x:Name="border"
                    Background="{TemplateBinding Background}"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="border" Property="Background" Value="#A08D61"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Secondary Button (White) -->
    <Style x:Key="BtnSecondaryWhite" TargetType="Button">
      <Setter Property="Background" Value="White"/>
      <Setter Property="Foreground" Value="Black"/>
      <Setter Property="Height" Value="40"/>
      <Setter Property="Padding" Value="24,10"/>
      <Setter Property="MinWidth" Value="140"/>
      <Setter Property="FontSize" Value="13"/>
      <Setter Property="FontWeight" Value="Medium"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border x:Name="border"
                    Background="{TemplateBinding Background}"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="{TemplateBinding Padding}">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="border" Property="Background" Value="#F8F8F8"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- ListBox Style (for Columns) -->
    <Style x:Key="ColumnListBox" TargetType="ListBox">
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="BorderBrush" Value="{StaticResource NeutralBorder}"/>
      <Setter Property="Background" Value="White"/>
      <Setter Property="SelectionMode" Value="Extended"/>
    </Style>

    <!-- ListBoxItem Style with Gold selection -->
    <Style TargetType="ListBoxItem">
      <Setter Property="Padding" Value="6,4"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ListBoxItem">
            <Border x:Name="Bd" 
                    BorderBrush="{TemplateBinding BorderBrush}" 
                    BorderThickness="{TemplateBinding BorderThickness}" 
                    Background="{TemplateBinding Background}" 
                    Padding="{TemplateBinding Padding}" 
                    SnapsToDevicePixels="true">
              <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                               SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                               VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="true">
                <Setter Property="Background" TargetName="Bd" Value="#F3F4F6"/>
              </Trigger>
              <Trigger Property="IsSelected" Value="true">
                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Gold}"/>
                <Setter Property="Foreground" Value="White"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- Style for Parameter ListBox (no selection styling) -->
    <Style x:Key="ParamListStyle" TargetType="ListBox">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VirtualizingStackPanel.IsVirtualizing" Value="True"/>
        <Setter Property="VirtualizingStackPanel.VirtualizationMode" Value="Recycling"/>
        <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Focusable" Value="False"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

  </Window.Resources>

  <Grid>
    <!-- Main Container with Shadow -->
    <Border Background="White"
            CornerRadius="16"
            Margin="24,24,24,88">
      <Border.Effect>
        <DropShadowEffect Color="Black" Direction="270" ShadowDepth="2" BlurRadius="20" Opacity="0.15"/>
      </Border.Effect>

      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>  <!-- Draggable Title Bar -->
          <RowDefinition Height="*"/>     <!-- Content -->
        </Grid.RowDefinitions>

        <Border Grid.Row="0" 
                Background="#F8FAFC"
                CornerRadius="16,16,0,0"
                Padding="24,16"
                MouseDown="TitleBar_MouseDown">
          <TextBlock Text="Bulk parameters"
                     FontSize="18"
                     FontWeight="SemiBold"
                     Foreground="{StaticResource T}"
                     VerticalAlignment="Center"/>
        </Border>

        <!-- Content Area -->
        <Grid Grid.Row="1" Margin="24,24,24,24">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <!-- Selection Columns -->
          <GroupBox Grid.Row="0" Header="Selectie">
            <Grid Height="250">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>

              <!-- Categories -->
              <DockPanel Grid.Column="0">
                <TextBlock DockPanel.Dock="Top" Text="CategorieÃ«n" Foreground="#6B7280" FontSize="12" Margin="0,0,0,6"/>
                <ListBox x:Name="lstCategories" SelectionMode="Single" DisplayMemberPath="Name" Style="{StaticResource ColumnListBox}"/>
              </DockPanel>

              <!-- Families -->
              <DockPanel Grid.Column="2">
                <TextBlock DockPanel.Dock="Top" Text="Families (Ctrl/Shift select)" Foreground="#6B7280" FontSize="12" Margin="0,0,0,6"/>
                <ListBox x:Name="lstFamilies" SelectionMode="Extended" DisplayMemberPath="Name" Style="{StaticResource ColumnListBox}"/>
              </DockPanel>

              <!-- Types -->
              <DockPanel Grid.Column="4">
                <TextBlock DockPanel.Dock="Top" Text="Types (Ctrl/Shift select)" Foreground="#6B7280" FontSize="12" Margin="0,0,0,6"/>
                <ListBox x:Name="lstTypes" SelectionMode="Extended" DisplayMemberPath="Name" Style="{StaticResource ColumnListBox}"/>
              </DockPanel>
            </Grid>
          </GroupBox>

          <!-- Parameters -->
          <GroupBox Grid.Row="1" Header="Type Parameters">
            <DockPanel>
              <Grid DockPanel.Dock="Top" Margin="0,0,0,12">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                  <TextBlock Text="Zoek parameter:" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#6B7280" FontSize="13"/>
                  <TextBox x:Name="txtParamSearch" Width="250" Style="{StaticResource StdTextBox}"/>
                </StackPanel>
              </Grid>

              <ListBox x:Name="lstParams" Style="{StaticResource ParamListStyle}" Margin="0,0,12,0">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,0,0,8" Opacity="{Binding Opacity}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="250"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="{Binding Name}" 
                                       VerticalAlignment="Center" 
                                       Margin="0,0,10,0" 
                                       TextTrimming="CharacterEllipsis" 
                                       ToolTip="{Binding Name}"
                                       Foreground="{Binding LabelForeground}"/>

                            <!-- Editor Area -->
                            <Grid Grid.Column="1">
                                <!-- Yes/No Editor -->
                                <CheckBox Visibility="{Binding IsYesNoVisible}" 
                                          IsChecked="{Binding YesNoValue}"
                                          Content="{Binding YesNoLabel}"
                                          Foreground="{Binding YesNoForeground}"
                                          IsThreeState="{Binding IsIndeterminate}"
                                          VerticalAlignment="Center"
                                          Click="BtnYesNo_Click"
                                          Tag="{Binding}"/>
                                
                                <!-- Material Editor -->
                                <ComboBox Visibility="{Binding IsMaterialVisible}"
                                          Style="{StaticResource StdComboBox}"
                                          ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=Materials}"
                                          SelectedItem="{Binding SelectedMaterial}"
                                          DisplayMemberPath="Name"
                                          Tag="{Binding}"/>
                                
                                <!-- Default Editor -->
                                <TextBox Visibility="{Binding IsDefaultVisible}"
                                         Style="{StaticResource StdTextBox}"
                                         Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                         Foreground="{Binding ValueForeground}"
                                         FontStyle="{Binding ValueFontStyle}"
                                         GotFocus="TextBox_GotFocus"
                                         Tag="{Binding}"/>
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </DockPanel>
          </GroupBox>
        </Grid>

      </Grid>
    </Border>

    <!-- Floating Action Buttons -->
    <StackPanel Orientation="Horizontal" 
                HorizontalAlignment="Right" 
                VerticalAlignment="Bottom"
                Margin="0,0,24,24">
      <Button x:Name="btnCancel" 
              Content="Annuleren" 
              Click="BtnCancel_Click"
              IsCancel="True"
              Style="{StaticResource BtnSecondaryWhite}"
              Margin="0,0,12,0"/>

      <Button x:Name="btnSave" 
              Content="Uitvoeren" 
              Click="BtnSave_Click"
              Style="{StaticResource BtnGold}"
              MinWidth="160"/>
    </StackPanel>
  </Grid>
</Window>
